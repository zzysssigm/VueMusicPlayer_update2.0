(function(){"use strict";var e={9450:function(e,t,i){var n=i(9963),s=i(6252),o=i(3577);const r={class:"background"},l={class:"music-player"},a=["src"],u={class:"search-bar"},c={key:0,class:"search-results"},h=["onClick"],d={class:"volume-slider"},g={class:"thecurrent"},p={class:"progress-bar-container"},f=["max"],m={class:"time-display"},y={class:"music-list"},v=["onClick"],S=["onClick"];function k(e,t,i,k,T,b){return(0,s.wg)(),(0,s.iD)("div",r,[(0,s._)("div",l,[(0,s._)("audio",{ref:"audio",src:T.currentSong.url,onTimeupdate:t[0]||(t[0]=(...e)=>b.updateProgress&&b.updateProgress(...e))},null,40,a),(0,s._)("button",{onClick:t[1]||(t[1]=(...e)=>b.selectFolder&&b.selectFolder(...e)),id:"selectButton"},"选择文件夹"),(0,s._)("button",{onClick:t[2]||(t[2]=(...e)=>b.playAll&&b.playAll(...e)),class:"control-button play-all"},"全部播放"),(0,s._)("button",{onClick:t[3]||(t[3]=(...e)=>b.pauseAll&&b.pauseAll(...e)),class:"control-button pause-all"},(0,o.zw)(b.pauseButtonText),1),(0,s._)("button",{ref:"loopButton",class:(0,o.C_)(["loop-button",{"loop-active":T.isLooping}]),onClick:t[4]||(t[4]=(...e)=>b.toggleLoop&&b.toggleLoop(...e))},"单曲循环",2),(0,s._)("div",u,[(0,s.wy)((0,s._)("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=e=>T.searchQuery=e),placeholder:"搜索歌曲",onInput:t[6]||(t[6]=(...e)=>b.searchSongs&&b.searchSongs(...e)),ref:"searchBar"},null,544),[[n.nr,T.searchQuery]]),(0,s._)("button",{onClick:t[7]||(t[7]=(...e)=>b.clearSearch&&b.clearSearch(...e))},"×"),T.filteredSongs.length>0?((0,s.wg)(),(0,s.iD)("ul",c,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(T.filteredSongs,((e,t)=>((0,s.wg)(),(0,s.iD)("li",{key:t,onClick:t=>b.playCorrectSong(e.name)},(0,o.zw)(e.name),9,h)))),128))])):(0,s.kq)("",!0)]),(0,s._)("div",d,[(0,s.wy)((0,s._)("input",{type:"range",min:"0",max:"100","onUpdate:modelValue":t[8]||(t[8]=e=>T.volume=e),class:"slider",onInput:t[9]||(t[9]=(...e)=>b.adjustVolume&&b.adjustVolume(...e))},null,544),[[n.nr,T.volume]])]),(0,s._)("div",g,"正在播放："+(0,o.zw)(T.currentSong.name),1),(0,s._)("div",p,[(0,s.wy)((0,s._)("input",{type:"range",min:"0",max:T.duration,"onUpdate:modelValue":t[10]||(t[10]=e=>T.currentTime=e),onInput:t[11]||(t[11]=(...e)=>b.seek&&b.seek(...e)),class:"progress-bar"},null,40,f),[[n.nr,T.currentTime]]),(0,s._)("div",m,(0,o.zw)(b.formatTime(T.currentTime))+" / "+(0,o.zw)(b.formatTime(T.duration)),1)]),(0,s._)("ul",y,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(T.songs,((e,t)=>((0,s.wg)(),(0,s.iD)("li",{key:t,onClick:e=>b.playSong(t)},[(0,s._)("button",{onClick:(0,n.iM)((e=>b.catchNextIndex(t)),["stop"])},"+",8,S),(0,s.Uk)(" "+(0,o.zw)(e.name),1)],8,v)))),128))])])])}i(560),i(8858),i(1318),i(3228);var T={data(){return{songs:[],currentSong:{name:"",url:""},currentTime:0,duration:0,isPlayingAll:!1,currentSongIndex:0,firstSongIndex:0,nextSongIndex:0,isLooping:!1,fadeOutInterval:null,initialVolume:1,searchQuery:"",filteredSongs:[],songsMap:{},volume:50}},computed:{pauseButtonText(){return this.isPlayingAll?"暂停":"继续播放"}},mounted(){document.addEventListener("click",this.outsideClickHandler)},beforeUnmount(){document.removeEventListener("click",this.outsideClickHandler)},methods:{play(){this.$refs.audio.play()},pause(){const e=this.$refs.audio;e.pause()},pauseAll(){const e=this.$refs.audio;e.paused?(this.isPlayingAll=!0,e.currentTime=this.currentTime,this.resetVolumeToInitial(),e.volume=this.initialVolume,e.play()):(this.isPlayingAll=!1,this.currentTime=e.currentTime,this.fadeOutAndPause())},playAll(){this.isPlayingAll?this.fadeOutAndPause().then((()=>{this.isPlayingAll=!0,this.playSong(this.firstSongIndex)})):(this.isPlayingAll=!0,this.playSong(this.firstSongIndex))},playSong(e){console.log(e),this.resetVolumeToInitial(),this.nextSongIndex=(this.currentSongIndex+1)%this.songs.length,this.isPlayingAll?this.fadeOutAndPause().then((()=>{this.currentSong=this.songs[e],this.currentSongIndex=e,this.$refs.audio.src=this.currentSong.url,this.$refs.audio.load(),this.resetVolumeToInitial(),this.playAudio()})):(this.isPlayingAll=!0,this.currentSong=this.songs[e],this.currentSongIndex=e,this.$refs.audio.src=this.currentSong.url,this.$refs.audio.load(),this.playAudio()),this.$refs.audio.addEventListener("ended",(()=>{this.isLooping?this.playSong(this.currentSongIndex):this.playSong(this.nextSongIndex)}),{once:!0}),this.$refs.audio.addEventListener("canplaythrough",(()=>{this.$refs.audio.play()}),{once:!0})},playAudio(){this.$refs.audio.addEventListener("canplaythrough",(()=>{this.$refs.audio.play()}),{once:!0})},catchNextIndex(e){console.log(e),this.nextSongIndex=e},fadeOutAndPause(){return new Promise((e=>{const t=this.$refs.audio,i=550,n=t.volume;function s(e,t,i,n){return i*Math.sin(e/n*(Math.PI/2))+t}let o=0;const r=setInterval((()=>{o<=i?(t.volume=s(o,n,-n,i),o+=100):(t.volume=0,clearInterval(r),this.pause(),e())}),100)}))},resetVolumeToInitial(){const e=this.$refs.audio;this.initialVolume=this.volume/100,e.volume=this.initialVolume},toggleLoop(){this.isLooping=!this.isLooping,this.$refs.loopButton.blur(),this.$refs.audio.loop=this.isLooping},updateProgress(e){this.currentTime=e.target.currentTime,this.duration=e.target.duration},seek(){this.$refs.audio.currentTime=this.currentTime},selectFolder(){const e=document.createElement("input");e.type="file",e.webkitdirectory=!0,e.directory=!0,e.multiple=!0,e.accept="audio/*",e.addEventListener("change",this.handleFolderSelection),e.click()},handleFolderSelection(e){const t=e.target.files;for(let i=0;i<t.length;i++)t[i].type.startsWith("audio/")&&(this.songs.push({name:t[i].name,url:URL.createObjectURL(t[i])}),this.songsMap[t[i].name]=this.songs.length-1);this.isPlayingAll||""!==this.currentSong.url.trim()?(this.waitingToPlay=!1,this.startPlayback()):this.waitingToPlay=!0},startPlayback(){this.waitingToPlay&&(this.isPlayingAll=!0,this.$refs.audio.paused?(this.currentTime>0?this.$refs.audio.currentTime=this.currentTime:this.$refs.audio.currentTime=0,this.$refs.audio.play()):this.$refs.audio.currentTime=this.currentTime)},formatTime(e){if(isNaN(e))return"0:00";const t=Math.floor(e/60),i=Math.floor(e%60);return`${t}:${i<10?"0":""}${i}`},searchSongs(){""!==this.searchQuery.trim()?this.filteredSongs=this.songs.filter((e=>e.name.toLowerCase().includes(this.searchQuery.toLowerCase()))):this.filteredSongs=[]},clearSearch(){this.searchQuery="",this.filteredSongs=[]},outsideClickHandler(e){const t=this.$refs.searchBar;t&&!t.contains(e.target)&&this.clearSearch()},playCorrectSong(e){this.playSong(this.songsMap[e])},adjustVolume(){const e=this.$refs.audio,t=this.volume/100;e.volume=t}}},b=i(3744);const x=(0,b.Z)(T,[["render",k]]);var w=x;(0,n.ri)(w).mount("#app")}},t={};function i(n){var s=t[n];if(void 0!==s)return s.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,i),o.exports}i.m=e,function(){var e=[];i.O=function(t,n,s,o){if(!n){var r=1/0;for(c=0;c<e.length;c++){n=e[c][0],s=e[c][1],o=e[c][2];for(var l=!0,a=0;a<n.length;a++)(!1&o||r>=o)&&Object.keys(i.O).every((function(e){return i.O[e](n[a])}))?n.splice(a--,1):(l=!1,o<r&&(r=o));if(l){e.splice(c--,1);var u=s();void 0!==u&&(t=u)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[n,s,o]}}(),function(){i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};i.O.j=function(t){return 0===e[t]};var t=function(t,n){var s,o,r=n[0],l=n[1],a=n[2],u=0;if(r.some((function(t){return 0!==e[t]}))){for(s in l)i.o(l,s)&&(i.m[s]=l[s]);if(a)var c=a(i)}for(t&&t(n);u<r.length;u++)o=r[u],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return i.O(c)},n=self["webpackChunkmusicplayer2"]=self["webpackChunkmusicplayer2"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=i.O(void 0,[998],(function(){return i(9450)}));n=i.O(n)})();
//# sourceMappingURL=app.343f4c67.js.map